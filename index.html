<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Solar System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #000;
            overflow: hidden;
            color: white;
        }

        #canvas-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar h1 {
            color: #ffd700;
            font-size: 1.5em;
            margin: 0;
        }

        .navbar-controls {
            display: flex;
            gap: 10px;
        }

        .control-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            z-index: 100;
            max-height: 50vh;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.3s ease-in-out;
        }

        .control-panel.open {
            transform: translateY(0);
        }

        .control-panel h2 {
            margin-bottom: 20px;
            color: #ffd700;
            text-align: center;
            font-size: 1.2em;
        }

        .planet-controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .planet-control {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .planet-control h4 {
            margin-bottom: 10px;
            color: #ffffff;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .speed-control input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #333;
            outline: none;
            cursor: pointer;
        }

        .speed-control input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ffd700;
            cursor: pointer;
            border: 2px solid #fff;
        }

        .speed-value {
            min-width: 50px;
            font-size: 0.9em;
            color: #ffd700;
            font-weight: bold;
        }

        .bottom-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 15px;
        }

        .control-button {
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #ffd700;
            border-radius: 25px;
            color: #ffd700;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .control-button:hover {
            background: rgba(255, 215, 0, 0.4);
            transform: translateY(-2px);
        }

        .control-button.active {
            background: #ffd700;
            color: #000;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .close-panel {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-panel:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: rotate(90deg);
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.8em;
            pointer-events: none;
            z-index: 1000;
            border: 1px solid #ffd700;
        }

        .planet-info-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 350px;
            max-height: calc(100vh - 120px);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            color: white;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 90;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .planet-info-panel.open {
            transform: translateX(0);
        }

        .planet-info-panel h3 {
            color: #ffd700;
            font-size: 1.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .planet-info-panel .close-info {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .planet-info-panel .close-info:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: rotate(90deg);
        }

        .planet-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 12px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .planet-stat:last-child {
            border-bottom: none;
        }

        .planet-stat-label {
            font-weight: bold;
            color: #ffd700;
        }

        .planet-stat-value {
            color: #ffffff;
        }

        .planet-description {
            margin-top: 20px;
            line-height: 1.6;
            color: #cccccc;
            font-size: 0.95em;
        }

        .controls-hint {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #ffd700;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.85em;
            border: 1px solid rgba(255, 215, 0, 0.3);
            z-index: 80;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffd700;
            font-size: 1.5em;
            z-index: 200;
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 10px 15px;
            }
            
            .navbar h1 {
                font-size: 1.2em;
            }
            
            .navbar-controls {
                gap: 8px;
            }
            
            .control-panel {
                padding: 15px;
                max-height: 60vh;
            }
            
            .planet-controls-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .planet-control {
                padding: 10px;
            }
            
            .planet-control h4 {
                font-size: 0.9em;
            }
            
            .speed-value {
                font-size: 0.8em;
                min-width: 45px;
            }
            
            .bottom-controls {
                gap: 10px;
            }
            
            .control-button {
                padding: 8px 15px;
                font-size: 0.8em;
            }

            .planet-info-panel {
                width: calc(100vw - 40px);
                right: 20px;
                left: 20px;
                max-height: 50vh;
            }

            .controls-hint {
                font-size: 0.75em;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div id="canvas-container">
        <div class="loading" id="loading">Loading Solar System...</div>
        
        <nav class="navbar">
            <h1>ü™ê 3D Solar System</h1>
            <div class="navbar-controls">
                <button class="control-button" id="controlsBtn">‚öôÔ∏è Controls</button>
                <button class="control-button" id="pauseBtn">‚è∏Ô∏è Pause</button>
                <button class="control-button" id="themeBtn">üåô Dark</button>
                <button class="control-button" id="starsBtn">‚≠ê Stars</button>
            </div>
        </nav>
        
        <div class="control-panel" id="controlPanel">
            <button class="close-panel" id="closePanel">‚úï</button>
            <h2>Planet Speed Controls</h2>
            
            <div class="planet-controls-grid" id="planet-controls"></div>
            
            <div class="bottom-controls">
                <button class="control-button" id="resetBtn">üîÑ Reset All Speeds</button>
            </div>
        </div>

        <div class="planet-info-panel" id="planetInfoPanel">
            <button class="close-info" id="closeInfo">‚úï</button>
            <div id="planetInfoContent"></div>
        </div>

        <div class="controls-hint">
            üñ±Ô∏è Click & drag to rotate ‚Ä¢ üîç Scroll to zoom ‚Ä¢ ü™ê Click planets for info
        </div>
        
        <div class="tooltip" id="tooltip" style="display: none;"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        class SolarSystem {
            constructor() {
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.planets = [];
                this.sun = null;
                this.stars = [];
                this.clock = new THREE.Clock();
                this.isPaused = false;
                this.isDarkMode = true;
                this.showStars = true;
                this.mouse = new THREE.Vector2();
                this.raycaster = new THREE.Raycaster();
                this.tooltip = document.getElementById('tooltip');
                
                // Camera controls
                this.cameraDistance = 45;
                this.cameraRotationX = 0.3;
                this.cameraRotationY = 0;
                this.isMouseDown = false;
                this.mouseDownPosition = { x: 0, y: 0 };
                
                this.planetData = [
                    { 
                        name: 'Mercury', 
                        size: 0.3, 
                        distance: 8, 
                        speed: 4.74, 
                        color: 0x8C7853,
                        info: {
                            diameter: '4,879 km',
                            mass: '3.3 √ó 10¬≤¬≥ kg',
                            distance_from_sun: '57.9 million km',
                            orbital_period: '88 Earth days',
                            day_length: '59 Earth days',
                            temperature: '-173¬∞C to 427¬∞C',
                            moons: '0',
                            description: 'Mercury is the smallest planet in our solar system and the closest to the Sun. It has extreme temperature variations and a heavily cratered surface similar to our Moon. Despite being closest to the Sun, it\'s not the hottest planet due to its lack of atmosphere.'
                        }
                    },
                    { 
                        name: 'Venus', 
                        size: 0.5, 
                        distance: 10, 
                        speed: 3.50, 
                        color: 0xFFD700,
                        info: {
                            diameter: '12,104 km',
                            mass: '4.87 √ó 10¬≤‚Å¥ kg',
                            distance_from_sun: '108.2 million km',
                            orbital_period: '225 Earth days',
                            day_length: '243 Earth days',
                            temperature: '462¬∞C (surface)',
                            moons: '0',
                            description: 'Venus is often called Earth\'s twin due to similar size and mass, but it\'s actually a hellish world with extreme greenhouse effect. Its thick atmosphere of carbon dioxide creates crushing pressure and scorching temperatures hot enough to melt lead.'
                        }
                    },
                    { 
                        name: 'Earth', 
                        size: 0.5, 
                        distance: 12, 
                        speed: 2.98, 
                        color: 0x6B93D6,
                        info: {
                            diameter: '12,756 km',
                            mass: '5.97 √ó 10¬≤‚Å¥ kg',
                            distance_from_sun: '149.6 million km',
                            orbital_period: '365.25 days',
                            day_length: '24 hours',
                            temperature: '-89¬∞C to 58¬∞C',
                            moons: '1 (Luna)',
                            description: 'Earth is our home planet and the only known world to harbor life. It has liquid water, a protective atmosphere, and a magnetic field that shields us from harmful solar radiation. About 71% of its surface is covered by oceans.'
                        }
                    },
                    { 
                        name: 'Mars', 
                        size: 0.4, 
                        distance: 14, 
                        speed: 2.41, 
                        color: 0xCD5C5C,
                        info: {
                            diameter: '6,792 km',
                            mass: '6.39 √ó 10¬≤¬≥ kg',
                            distance_from_sun: '227.9 million km',
                            orbital_period: '687 Earth days',
                            day_length: '24.6 hours',
                            temperature: '-87¬∞C to -5¬∞C',
                            moons: '2 (Phobos, Deimos)',
                            description: 'Mars, the Red Planet, gets its color from iron oxide (rust) on its surface. It has the largest volcano in the solar system (Olympus Mons) and evidence suggests it once had liquid water. It\'s a prime target for future human exploration.'
                        }
                    },
                    { 
                        name: 'Jupiter', 
                        size: 1.2, 
                        distance: 18, 
                        speed: 1.31, 
                        color: 0xD8CA9D,
                        info: {
                            diameter: '142,984 km',
                            mass: '1.90 √ó 10¬≤‚Å∑ kg',
                            distance_from_sun: '778.5 million km',
                            orbital_period: '12 Earth years',
                            day_length: '9.9 hours',
                            temperature: '-108¬∞C (cloud tops)',
                            moons: '79+ (including Io, Europa, Ganymede, Callisto)',
                            description: 'Jupiter is the largest planet in our solar system, a gas giant with a mass greater than all other planets combined. Its Great Red Spot is a storm larger than Earth that has raged for centuries. It acts as a cosmic vacuum cleaner, protecting inner planets from asteroids and comets.'
                        }
                    },
                    { 
                        name: 'Saturn', 
                        size: 1.0, 
                        distance: 22, 
                        speed: 0.97, 
                        color: 0xFAD5A5,
                        info: {
                            diameter: '120,536 km',
                            mass: '5.68 √ó 10¬≤‚Å∂ kg',
                            distance_from_sun: '1.43 billion km',
                            orbital_period: '29 Earth years',
                            day_length: '10.7 hours',
                            temperature: '-139¬∞C (cloud tops)',
                            moons: '82+ (including Titan, Enceladus)',
                            description: 'Saturn is famous for its spectacular ring system made of ice and rock particles. It\'s less dense than water and would float if there were an ocean large enough! Its moon Titan has lakes of liquid methane and is considered one of the most Earth-like worlds in our solar system.'
                        }
                    },
                    { 
                        name: 'Uranus', 
                        size: 0.8, 
                        distance: 26, 
                        speed: 0.68, 
                        color: 0x4FD0E4,
                        info: {
                            diameter: '51,118 km',
                            mass: '8.68 √ó 10¬≤‚Åµ kg',
                            distance_from_sun: '2.87 billion km',
                            orbital_period: '84 Earth years',
                            day_length: '17.2 hours',
                            temperature: '-197¬∞C (cloud tops)',
                            moons: '27+ (including Miranda, Ariel)',
                            description: 'Uranus is unique for rotating on its side, likely due to an ancient collision. This ice giant has a faint ring system and its blue-green color comes from methane in its atmosphere. It experiences extreme seasons lasting 21 Earth years each.'
                        }
                    },
                    { 
                        name: 'Neptune', 
                        size: 0.8, 
                        distance: 30, 
                        speed: 0.54, 
                        color: 0x4169E1,
                        info: {
                            diameter: '49,528 km',
                            mass: '1.02 √ó 10¬≤‚Å∂ kg',
                            distance_from_sun: '4.50 billion km',
                            orbital_period: '165 Earth years',
                            day_length: '16.1 hours',
                            temperature: '-201¬∞C (cloud tops)',
                            moons: '14+ (including Triton)',
                            description: 'Neptune is the windiest planet with speeds reaching 2,100 km/h. This deep blue ice giant was the first planet discovered through mathematical prediction rather than observation. Its largest moon, Triton, orbits backwards and likely is a captured Kuiper Belt object.'
                        }
                    }
                ];
                
                this.init();
            }
            
            init() {
                this.createScene();
                this.createCamera();
                this.createRenderer();
                this.createLights();
                this.createSun();
                this.createPlanets();
                this.createStars();
                this.createControls();
                this.setupEventListeners();
                this.animate();
                
                document.getElementById('loading').style.display = 'none';
            }
            
            createScene() {
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0x000000);
            }
            
            createCamera() {
                this.camera = new THREE.PerspectiveCamera(
                    75,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    1000
                );
                this.updateCameraPosition();
            }

            updateCameraPosition() {
                this.camera.position.x = Math.sin(this.cameraRotationY) * Math.cos(this.cameraRotationX) * this.cameraDistance;
                this.camera.position.y = Math.sin(this.cameraRotationX) * this.cameraDistance;
                this.camera.position.z = Math.cos(this.cameraRotationY) * Math.cos(this.cameraRotationX) * this.cameraDistance;
                this.camera.lookAt(0, 0, 0);
            }
            
            createRenderer() {
                this.renderer = new THREE.WebGLRenderer({ antialias: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                document.getElementById('canvas-container').appendChild(this.renderer.domElement);
            }
            
            createLights() {
                // Ambient light
                const ambientLight = new THREE.AmbientLight(0x404040, 0.3);
                this.scene.add(ambientLight);
                
                // Point light from sun
                const pointLight = new THREE.PointLight(0xffffff, 2, 100);
                pointLight.position.set(0, 0, 0);
                pointLight.castShadow = true;
                pointLight.shadow.mapSize.width = 2048;
                pointLight.shadow.mapSize.height = 2048;
                this.scene.add(pointLight);
            }
            
            createSun() {
                const sunGeometry = new THREE.SphereGeometry(2, 32, 32);
                const sunMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xFDB813,
                    emissive: 0xFDB813,
                    emissiveIntensity: 0.3
                });
                this.sun = new THREE.Mesh(sunGeometry, sunMaterial);
                this.sun.userData = { 
                    name: 'Sun', 
                    type: 'sun',
                    info: {
                        diameter: '1.39 million km',
                        mass: '1.99 √ó 10¬≥‚Å∞ kg',
                        temperature: '5,778 K (surface)',
                        age: '4.6 billion years',
                        composition: '73% Hydrogen, 25% Helium',
                        description: 'The Sun is a yellow dwarf star at the center of our solar system. It contains 99.86% of the system\'s mass and generates energy through nuclear fusion, converting hydrogen into helium in its core. Without the Sun, life on Earth would not exist.'
                    }
                };
                this.scene.add(this.sun);
            }
            
            createPlanets() {
                this.planetData.forEach((data, index) => {
                    const planetGeometry = new THREE.SphereGeometry(data.size, 32, 32);
                    const planetMaterial = new THREE.MeshLambertMaterial({ color: data.color });
                    const planet = new THREE.Mesh(planetGeometry, planetMaterial);
                    
                    planet.castShadow = true;
                    planet.receiveShadow = true;
                    planet.position.x = data.distance;
                    planet.userData = {
                        name: data.name,
                        type: 'planet',
                        distance: data.distance,
                        speed: data.speed,
                        originalSpeed: data.speed,
                        angle: Math.random() * Math.PI * 2,
                        info: data.info
                    };
                    
                    // Create orbit line
                    const orbitGeometry = new THREE.RingGeometry(data.distance - 0.1, data.distance + 0.1, 64);
                    const orbitMaterial = new THREE.MeshBasicMaterial({
                        color: 0x444444,
                        side: THREE.DoubleSide,
                        transparent: true,
                        opacity: 0.3
                    });
                    const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                    orbit.rotation.x = -Math.PI / 2;
                    this.scene.add(orbit);
                    
                    this.scene.add(planet);
                    this.planets.push(planet);
                });
            }
            
            createStars() {
                const starsGeometry = new THREE.BufferGeometry();
                const starsCount = 1000;
                const positions = new Float32Array(starsCount * 3);
                
                for (let i = 0; i < starsCount * 3; i += 3) {
                    positions[i] = (Math.random() - 0.5) * 200;
                    positions[i + 1] = (Math.random() - 0.5) * 200;
                    positions[i + 2] = (Math.random() - 0.5) * 200;
                }
                
                starsGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.5 });
                const starsField = new THREE.Points(starsGeometry, starsMaterial);
                this.scene.add(starsField);
                this.stars.push(starsField);
            }

            showPlanetInfo(celestialBody) {
                const infoPanel = document.getElementById('planetInfoPanel');
                const infoContent = document.getElementById('planetInfoContent');
                
                let content = `<h3>${celestialBody.userData.name}</h3>`;
                
                if (celestialBody.userData.type === 'sun') {
                    content += `
                        <div class="planet-stat">
                            <span class="planet-stat-label">Diameter:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.diameter}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Mass:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.mass}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Surface Temperature:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.temperature}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Age:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.age}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Composition:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.composition}</span>
                        </div>
                    `;
                } else {
                    content += `
                        <div class="planet-stat">
                            <span class="planet-stat-label">Diameter:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.diameter}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Mass:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.mass}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Distance from Sun:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.distance_from_sun}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Orbital Period:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.orbital_period}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Day Length:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.day_length}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Temperature:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.temperature}</span>
                        </div>
                        <div class="planet-stat">
                            <span class="planet-stat-label">Moons:</span>
                            <span class="planet-stat-value">${celestialBody.userData.info.moons}</span>
                        </div>
                    `;
                }
                
                content += `<div class="planet-description">${celestialBody.userData.info.description}</div>`;
                
                infoContent.innerHTML = content;
                infoPanel.classList.add('open');
            }
            
            createControls() {
                const controlsContainer = document.getElementById('planet-controls');
                
                this.planets.forEach((planet, index) => {
                    const planetControl = document.createElement('div');
                    planetControl.className = 'planet-control';
                    
                    planetControl.innerHTML = `
                        <h4>ü™ê ${planet.userData.name}</h4>
                        <div class="speed-control">
                            <input type="range" 
                                   id="speed-${index}" 
                                   min="0" 
                                   max="10" 
                                   value="${planet.userData.speed}" 
                                   step="0.1">
                            <span class="speed-value" id="value-${index}">${planet.userData.speed.toFixed(1)}x</span>
                        </div>
                    `;
                    
                    controlsContainer.appendChild(planetControl);
                    
                    const slider = document.getElementById(`speed-${index}`);
                    const valueDisplay = document.getElementById(`value-${index}`);
                    
                    slider.addEventListener('input', (e) => {
                        const newSpeed = parseFloat(e.target.value);
                        planet.userData.speed = newSpeed;
                        valueDisplay.textContent = newSpeed.toFixed(1) + 'x';
                    });
                });
            }
            
            setupEventListeners() {
                // Controls panel toggle
                const controlsBtn = document.getElementById('controlsBtn');
                const controlPanel = document.getElementById('controlPanel');
                const closePanel = document.getElementById('closePanel');
                
                const toggleControlPanel = () => {
                    controlPanel.classList.toggle('open');
                    controlsBtn.classList.toggle('active');
                    controlsBtn.textContent = controlPanel.classList.contains('open') ? '‚úï Close' : '‚öôÔ∏è Controls';
                };
                
                controlsBtn.addEventListener('click', toggleControlPanel);
                closePanel.addEventListener('click', toggleControlPanel);

                // Planet info panel
                const planetInfoPanel = document.getElementById('planetInfoPanel');
                const closeInfo = document.getElementById('closeInfo');
                
                closeInfo.addEventListener('click', () => {
                    planetInfoPanel.classList.remove('open');
                });
                
                // Pause/Resume
                document.getElementById('pauseBtn').addEventListener('click', () => {
                    this.isPaused = !this.isPaused;
                    const btn = document.getElementById('pauseBtn');
                    btn.textContent = this.isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
                    btn.classList.toggle('active', this.isPaused);
                });
                
                // Theme toggle
                document.getElementById('themeBtn').addEventListener('click', () => {
                    this.isDarkMode = !this.isDarkMode;
                    const btn = document.getElementById('themeBtn');
                    if (this.isDarkMode) {
                        this.scene.background = new THREE.Color(0x000000);
                        btn.textContent = 'üåô Dark';
                    } else {
                        this.scene.background = new THREE.Color(0x1a1a2e);
                        btn.textContent = '‚òÄÔ∏è Light';
                    }
                    btn.classList.toggle('active', !this.isDarkMode);
                });
                
                // Stars toggle
                document.getElementById('starsBtn').addEventListener('click', () => {
                    this.showStars = !this.showStars;
                    const btn = document.getElementById('starsBtn');
                    this.stars.forEach(star => {
                        star.visible = this.showStars;
                    });
                    btn.textContent = this.showStars ? '‚≠ê Stars' : 'üí´ No Stars';
                    btn.classList.toggle('active', !this.showStars);
                });
                
                // Reset speeds
                document.getElementById('resetBtn').addEventListener('click', () => {
                    this.planets.forEach((planet, index) => {
                        planet.userData.speed = planet.userData.originalSpeed;
                        document.getElementById(`speed-${index}`).value = planet.userData.originalSpeed;
                        document.getElementById(`value-${index}`).textContent = planet.userData.originalSpeed.toFixed(1) + 'x';
                    });
                });
                
                // Enhanced 3D Camera Controls
                this.renderer.domElement.addEventListener('mousedown', (event) => {
                    this.isMouseDown = true;
                    this.mouseDownPosition.x = event.clientX;
                    this.mouseDownPosition.y = event.clientY;
                    this.renderer.domElement.style.cursor = 'grabbing';
                });
                
                document.addEventListener('mouseup', () => {
                    this.isMouseDown = false;
                    this.renderer.domElement.style.cursor = 'grab';
                });
                
                this.renderer.domElement.addEventListener('mousemove', (event) => {
                    if (this.isMouseDown) {
                        const deltaX = event.clientX - this.mouseDownPosition.x;
                        const deltaY = event.clientY - this.mouseDownPosition.y;
                        
                        this.cameraRotationY += deltaX * 0.01;
                        this.cameraRotationX += deltaY * 0.01;
                        
                        // Limit vertical rotation
                        this.cameraRotationX = Math.max(-Math.PI/2 + 0.1, Math.min(Math.PI/2 - 0.1, this.cameraRotationX));
                        
                        this.mouseDownPosition.x = event.clientX;
                        this.mouseDownPosition.y = event.clientY;
                        
                        this.updateCameraPosition();
                    }
                    
                    // Update mouse position for raycasting
                    this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                    this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
                    
                    this.raycaster.setFromCamera(this.mouse, this.camera);
                    const intersects = this.raycaster.intersectObjects([...this.planets, this.sun]);
                    
                    if (intersects.length > 0 && !this.isMouseDown) {
                        const object = intersects[0].object;
                        this.tooltip.textContent = `${object.userData.name} - Click for details`;
                        this.tooltip.style.display = 'block';
                        this.tooltip.style.left = event.clientX + 10 + 'px';
                        this.tooltip.style.top = event.clientY - 30 + 'px';
                        this.renderer.domElement.style.cursor = 'pointer';
                    } else {
                        this.tooltip.style.display = 'none';
                        this.renderer.domElement.style.cursor = this.isMouseDown ? 'grabbing' : 'grab';
                    }
                });
                
                // Mouse wheel for zooming
                this.renderer.domElement.addEventListener('wheel', (event) => {
                    event.preventDefault();
                    this.cameraDistance += event.deltaY * 0.01;
                    this.cameraDistance = Math.max(10, Math.min(100, this.cameraDistance));
                    this.updateCameraPosition();
                });
                
                // Click to show planet info
                this.renderer.domElement.addEventListener('click', (event) => {
                    if (!this.isMouseDown) {
                        this.raycaster.setFromCamera(this.mouse, this.camera);
                        const intersects = this.raycaster.intersectObjects([...this.planets, this.sun]);
                        
                        if (intersects.length > 0) {
                            const clickedObject = intersects[0].object;
                            this.showPlanetInfo(clickedObject);
                        }
                    }
                });
                
                this.renderer.domElement.addEventListener('mouseleave', () => {
                    this.tooltip.style.display = 'none';
                    this.renderer.domElement.style.cursor = 'grab';
                });
                
                // Set initial cursor
                this.renderer.domElement.style.cursor = 'grab';
                
                // Close panels when clicking outside
                document.addEventListener('click', (e) => {
                    if (!controlPanel.contains(e.target) && !controlsBtn.contains(e.target) && controlPanel.classList.contains('open')) {
                        toggleControlPanel();
                    }
                    if (!planetInfoPanel.contains(e.target) && planetInfoPanel.classList.contains('open') && 
                        !this.renderer.domElement.contains(e.target)) {
                        planetInfoPanel.classList.remove('open');
                    }
                });
                
                // Window resize
                window.addEventListener('resize', () => {
                    this.camera.aspect = window.innerWidth / window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                });

                // Touch controls for mobile
                let touchStartX = 0;
                let touchStartY = 0;
                
                this.renderer.domElement.addEventListener('touchstart', (event) => {
                    if (event.touches.length === 1) {
                        touchStartX = event.touches[0].clientX;
                        touchStartY = event.touches[0].clientY;
                    }
                });
                
                this.renderer.domElement.addEventListener('touchmove', (event) => {
                    event.preventDefault();
                    if (event.touches.length === 1) {
                        const deltaX = event.touches[0].clientX - touchStartX;
                        const deltaY = event.touches[0].clientY - touchStartY;
                        
                        this.cameraRotationY += deltaX * 0.01;
                        this.cameraRotationX += deltaY * 0.01;
                        
                        this.cameraRotationX = Math.max(-Math.PI/2 + 0.1, Math.min(Math.PI/2 - 0.1, this.cameraRotationX));
                        
                        touchStartX = event.touches[0].clientX;
                        touchStartY = event.touches[0].clientY;
                        
                        this.updateCameraPosition();
                    }
                });
                
                // Touch zoom
                let initialDistance = 0;
                this.renderer.domElement.addEventListener('touchstart', (event) => {
                    if (event.touches.length === 2) {
                        const dx = event.touches[0].clientX - event.touches[1].clientX;
                        const dy = event.touches[0].clientY - event.touches[1].clientY;
                        initialDistance = Math.sqrt(dx * dx + dy * dy);
                    }
                });
                
                this.renderer.domElement.addEventListener('touchmove', (event) => {
                    if (event.touches.length === 2) {
                        event.preventDefault();
                        const dx = event.touches[0].clientX - event.touches[1].clientX;
                        const dy = event.touches[0].clientY - event.touches[1].clientY;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (initialDistance > 0) {
                            const scale = distance / initialDistance;
                            this.cameraDistance /= scale;
                            this.cameraDistance = Math.max(10, Math.min(100, this.cameraDistance));
                            this.updateCameraPosition();
                            initialDistance = distance;
                        }
                    }
                });
            }
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                if (!this.isPaused) {
                    const delta = this.clock.getDelta();
                    
                    // Rotate sun
                    this.sun.rotation.y += delta * 0.5;
                    
                    // Update planets
                    this.planets.forEach(planet => {
                        // Orbit around sun
                        planet.userData.angle += delta * planet.userData.speed * 0.1;
                        planet.position.x = Math.cos(planet.userData.angle) * planet.userData.distance;
                        planet.position.z = Math.sin(planet.userData.angle) * planet.userData.distance;
                        
                        // Rotate planet on its axis
                        planet.rotation.y += delta * 2;
                    });
                }
                
                this.renderer.render(this.scene, this.camera);
            }
        }
        
        // Initialize when page loads
        window.addEventListener('load', () => {
            new SolarSystem();
        });
    </script>
</body>
</html>